// Datei: ./praxis/aehnliche-pakete-finden/suche-anhand-der-paketkategorien.adoc
// Baustelle: Rohtext

[[aehnliche-pakete-finden-paketkategorien]]
=== Suche anhand der Paketkategorien ===

// Stichworte für den Index
(((ähnliche Pakete finden, Suche anhand der Paketkategorien)))
Die Paketverwaltung stellt die Debianpakete in verschiedenen Kategorien
bereit (siehe <<sortierung-der-pakete-nach-verwendungszweck>>). Hier 
haben die Paketmaintainer gute Vorarbeit geleistet. Für ähnliche Pakete 
hilft ein Blick in die jeweilige Kategorie.

==== Über die Kommandozeile ====

// Stichworte für den Index
(((apt-cache, show)))
`dpkg`, `apt` und `apt-get` verfügen nicht über ein passendes 
Unterkommando, um nach Paketen zu suchen, die sich in einer bestimmten 
Paketkategorie befinden oder zueinander ähnlich sind. Hier hilft nur ein 
zweistufiges Verfahren basierend auf dem Auslesen der Daten in der 
Paketbeschreibung.

*Schritt 1* beinhaltet die Ermittlung der Paketkategorie, in der das Paket 
einsortiert wurde. Dazu verfügt jedes Paket in der Paketbeschreibung über
einen Eintrag zur Kategorie, das Schlüsselwort heißt `Section`. Von 
Nutzen sind hier die beiden Werkzeuge `apt-cache` und `apt` in Kombination
mit `sed`. Unerheblich ist, ob das Paket bereits installiert ist, oder 
nicht.

Nach dem Paket 'bash' suchen Sie mittels `apt-cache` und `sed` wie folgt
(*Variante 1*):

.Ermittlung der Paketkategorie mittels `apt-cache`
----
$ apt-cache show bash | sed -ne '/^Section: /{s/Section: //p;}'
shells
$
----

`sed` berücksichtigt in der Ausgabe von `apt-cache` nur die Zeilen, die mit 
der Zeichenkette `Section:` beginnen und ersetzt darin `Section:` durch 
nichts -- löscht also die Zeichenkette. Übrig bleibt die Bezeichnung der 
Paketkategorie.

// Stichworte für den Index
(((apt, show)))
*Variante 2* verwendet `apt` mit dem Unterkommando `show` in Kombination 
mit `tail` und `sed`. Der Zwischenschritt über `tail` ist hier notwendig,
da die Ausgabe von `apt` mit zusätzlichen Zeilen beginnt, die wir nicht 
benötigen. Für das Paket `cleo` sieht der Aufruf wie folgt aus:

.Ermittlung der Paketkategorie mittels `apt`
----
$ apt show cleo 2>1 | tail -n+4 | sed -ne '/^Section: /{s/Section: //p;}'
shells
$
----

Nun kommen wir zu *Schritt 2*. In diesem ermitteln wir weitere Pakete aus 
der Kategorie, hier am Beispiel der Kategorie 'shell'. Zur Umsetzung stehen
wieder zwei Varianten bereit -- Variante 1 nutzt `apt` und Variante 2
`aptitude`. Das Ergebnis ist jeweils identisch.

// Stichworte für den Index
(((apt, list)))
*Variante 1* ist eine Kombination aus `apt` mit `tail`, `awk` und `sort`,
die Sie über eine Pipe miteinander verbinden. `apt` rufen Sie mit dem 
Unterkommando `list` und einem Filter auf. Der Filter ist `~sshell` (ohne 
Leerzeichen zwischen `~s` und der angegebenen Kategorie) und weist `apt` 
an, lediglich in der Kategorie 'shell' zu suchen. Alle Ausgaben leiten Sie
mittels `2>1` in die Standardausgabe um, woraus `tail` die erste Zeile 
abschneidet. Mittels `awk` reduzieren Sie jede Zeile auf die erste Spalte.
Zuletzt faßt `sort` gleiche Zeilen zusammen und sortiert die Zeilen 
aufsteigend.

.Alle Pakete der Kategorie 'shell' mittels `apt` ausgeben
----
$ apt list '~sshell' 2>1 | tail -n+2 | awk -F '/' '{ print $1 }' | sort -u
ash
autojump
bash
bash-completion
bash-static
bats
busybox-static
...
$
----

// Stichworte für den Index
(((aptitude, search)))
*Variante 2* nutzt initial `aptitude` und flanscht daran `awk`, `sed` und 
`sort` an. `aptitude` rufen Sie mit dem Unterkommando `search` und einem 
Filter auf. Der Filter ist ähnlich zu obigem Beispiel von `apt` mit einem
Unterschied: es sind beide Schreibweisen zulässig -- `~sshell` und 
`~s shell` (ohne und mit Leerzeichen zwischen `~s` und der angegebenen 
Kategorie). Alle Ausgaben leiten Sie an `awk` weiter, welches jede Zeile 
auf die zweite Spalte reduziert. Danach ersetzt `sed` alle Zeichen ab dem
Doppelpunkt durch nichts (löscht die Zeichen). Zuletzt sortiert `sort` die
Zeilen aufsteigend und faßt zudem mit Hilfe des Schalters `-u` auch noch 
gleiche Zeilen zusammen.

.Alle Pakete der Kategorie 'shell' mittels `aptitude` ausgeben
----
$ aptitude search '~s shell' | awk '{ print $2 }' | sed -e 's/:.*//p' | sort -u
ash
autojump
bash
bash-completion
bash-static
bats
busybox-static
...
$
----

Zur Automatisierung bietet sich *Schritt 3* an -- die Kombination von 
Schritt 1 und 2 als Shellskript. Nachfolgend ist das beispielhaft mittels 
`apt` realisiert. Hierbei haben wir jede Anweisung in eine einzelne Zeile
verlegt, um das Shellskript lesbar zu halten.

Das Shellskript erwartet einen Aufrufparameter. Das ist das Debianpaket, 
zu dem die Recherche erfolgen soll.

.Alle ähnlichen Pakete mit einem Shellskript aufstöbern
----
#!/bin/bash

paketname="$1"
kategorie=$(
  apt show ${paketname} 2>1 | \ 
  tail -n+4 | \ 
  sed -ne '/^Section: /{s/Section: //p;}' \
  )
apt list "~s${kategorie}" 2>1 | \ 
  tail -n+2 | \ 
  awk -F '/' '{ print $1 }' | \ 
  sort -u
----

Haben Sie das Shellskript unter dem Namen 'finde-aehnliche-pakete.sh' 
gespeichert und diesem mittels `chmod u+x` ausführbare Berechtigungen 
erteilt, ist der Aufruf für das Paket 'bash' wie folgt:

----
$ ./finde-aehnliche-pakete.sh bash
----

==== Über eine GUI ====

Textbasierte und graphische Bedienoberflächen integrieren die Anzeige und 
Recherche innerhalb der Paketkategorien auf unterschiedliche Art und Weise. 
Nach unserem aktuellen Wissensstand und Gegenprüfung mit den Werkzeugen aus
<<gui-zur-paketverwaltung>> wird das derzeit wie folgt umgesetzt:

TUI von `aptitude` :: die Auflistung der Pakete enthält in der Baumstruktur
die beiden Bereiche 'Installierte Pakete' und 'Nicht installierte Pakete'. 
Die Pakete darin sind jeweils wieder den einzelnen Paketkategorien -- hier
genannt Bereiche -- zugordnet. Zusätzlich liefert `aptitude` einen 'Debtags
Browser' mit (siehe <<aehnliche-pakete-finden-debtags>>).

GUI von Synaptic :: über die unten angeordneten Knöpfe im linken Panel 
wählen Sie zunächst die Ansicht nach Bereichen aus, wobei daraufhin in der 
Mitte die dazugehörigen Softwarepakete aufgelistet werden. Die Farbe des 
Icons neben dem Namen des Softwarepakets zeigt lediglich an, ob dieses Paket 
bereits installiert ist, oder nicht. Eine weitere Angabe von 
Vergleichskriterien zwischen den Paketen ist nicht integriert.

GUI von apper und Gnome Packagekit :: in der zweiteiligen Ansicht wählen Sie
zuerst die jeweilige Paketkategorie aus, hier genannt Gruppe. Im rechten
Fenster werden nun alle Pakete dargestellt, die zu der Gruppe gehören (siehe
<<fig.gnome-packagekit-netzwerk>>).

.Recherche in der Kategorie Netzwerk über das Gnome Packagekit (Pakete)
image::praxis/aehnliche-pakete-finden/gnome-packagekit-netzwerk.png[id="fig.gnome-packagekit-netzwerk", width="60%"]

==== Über einen Webbrowser ====

Die in <<webbasierte-programme>> genannten Werkzeuge erlauben keine
Recherche anhand der hinterlegten Paketkategorien, was wir als betrüblich
ansehen. Somit bleibt nur der Rückgriff auf andere Ressourcen.

* Paketsuche über die Kategorien-Übersicht auf debian.org
* Paketsuche über packages.debian.org

// Datei (Ende): ./praxis/aehnliche-pakete-finden/suche-anhand-der-paketkategorien.adoc
